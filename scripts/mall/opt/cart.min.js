/*!
 * Powered by uglifiyJS v2.6.1, Build by http://jsmin.6tie.net
 * build time: Tue Jul 21 2020 21:08:54 GMT+0800 (China Standard Time)
*/
function calcPrice(){var e=0,a=0;$.map($table.bootstrapTable("getSelections"),function(t){e++;var l=parseFloat($("#sm_"+t.id).val()),n=parseFloat(t.pd_price);a+=l*n}),$("#lab_linkcount").text(e),$("#lab_amount").text(a)}function operateFormatter(e,a,t){var l='<div class="hidden-sm hidden-xs btn-group">';return l+='<button type="button" class="btn btn-danger btn-xs" data-toggle="modal" onclick="toDelete(\''+a.id+'\')"><i class="ace-icon fa fa-trash-o"></i>&nbsp;\u5220\u9664</button>&nbsp;&nbsp;',l+="</div>",l+='<div class="hidden-md hidden-lg"> <div class="inline pos-rel"> <button class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" data-position="auto"> <i class="ace-icon fa fa-cog icon-only bigger-110"></i> </button> <ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">',l+='<li> <a href="#" onclick="toDelete(\''+a.id+'\')" class="tooltip-info" data-rel="tooltip"> <span class="red"> <i class="ace-icon fa fa-trash-o"></i> \u5220\u9664</span> </a> </li>',l+="</ul></div></div>"}function siteDomainFormatter(e,a,t){return"<a href='/website/"+a.id+".html' target='_blank'>"+e+"</a>"}function siteAllowFormatter(e,a,t){return 1==e?'<span class="label label-success">\u5141\u8bb8</span>':'<span class="label label-danger">\u4e0d\u5141\u8bb8</span>'}function pdNumFormatter(e,a,t){var l="<select onchange='selectMonth("+a.id+")' name=\"pd_count\" id='sm_"+a.id+"' class='m_select'>";return $.each(month_data,function(a,t){var n="";e==t.value&&(n="selected"),l+='<option value="'+t.value+'" '+n+">"+t.name+"</option>"}),l+="</select>"}function toDelete(e){myConfirm(function(){ajax("?method=delete",{id:e},"POST",saveHandle,!0,!0)},"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u9009\u9879\u5417\uff1f","\u5220\u9664")}function DeleteAll(){var e=getIdSelections($table);e&&e.length>0?myConfirm(function(){ajax("?method=delete",{ids:e.join(",")},"POST",saveHandle,!0,!0)},"\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684\u9009\u9879\u5417\uff1f","\u5220\u9664"):popTip("\u8bf7\u5148\u9009\u62e9\u8981\u5220\u9664\u7684\u9009\u9879")}function saveHandle(e){$("#delete_modal").modal("hide"),$table.bootstrapTable("refresh")}function selectMonth(e){if(e){var a=$("#sm_"+e).val();ajax("?method=update",{id:e,value:a},"POST",function(){calcPrice()},!1,!0)}}function batchSelectMonth(e){e.value&&($(".m_select").val(e.value),ajax("?method=update",{value:e.value},"POST",function(){calcPrice()},!1,!0))}function next(){var e=getIdSelections($table);if(e&&e.length>0){var a=parseFloat($("#lab_balance").text()),t=parseFloat($("#lab_amount").text());if(t>a)return popTip("\u4f59\u989d\u4e0d\u8db3,\u8bf7\u5148\u5145\u503c"),!1;var l=$("#shipping_addr").val();if(""==l)return popTip("\u8bf7\u5148\u9009\u62e9\u63a8\u5e7f\u94fe\u63a5"),!1;myConfirm(function(){ajax("?method=confirmOrder",{ids:e.join(","),addr_id:l},"POST",confirmOrderHandle,!0,!0)},"\u786e\u8ba4\u8981\u8d2d\u4e70\u94fe\u63a5\u8ba2\u5355\uff1f","\u786e\u8ba4")}else popTip("\u8bf7\u5148\u9009\u62e9\u8981\u8d2d\u4e70\u7684\u94fe\u63a5")}function toAdd(){buildForm("container_data",columns_table_addr),$("#add_modal").modal({backdrop:!0,keyboard:!0,show:!0})}function submitForm(){vform.form()&&ajax("?method=saveShippingAddr","validation-form","POST",getShippingAddr,!0,!0)}function getShippingAddr(){$("#add_modal").modal("hide"),ajax("?method=getShippingAddr","validation-form","POST",getShippingAddrHandle,!1,!0)}function getShippingAddrHandle(e){if(1==e.code){var a='<option value="">\u8bf7\u9009\u62e9\u8981\u63a8\u5e7f\u7684\u94fe\u63a5</option>',t=e.datas;$.each(t,function(e,t){a+='<option value="'+t.id+'">'+t.rel_name+"("+t.rel_addr+")</option>"}),$("#shipping_addr").empty().append(a)}}function confirmOrderHandle(e){1==e.code&&($("#pay-opt").addClass("hidden"),$("#pay-success-tip").removeClass("hidden"))}var columns_table=[];columns_table.push({field:"state",checkbox:!0,align:"center",valign:"middle"}),columns_table.push({title:"ID",field:"id",visible:!1}),columns_table.push({title:"\u7f51\u7ad9\u540d\u79f0",field:"pd_name",align:"center",valign:"middle"}),columns_table.push({title:"\u7f51\u7ad9\u57df\u540d",field:"site_domain",align:"left",valign:"middle","class":"hidden-480",formatter:"siteDomainFormatter"}),columns_table.push({title:"\u5355\u4ef7(\u5143)",field:"pd_price",align:"center",valign:"middle","class":"hidden-480"}),columns_table.push({title:"\u654f\u611f\u8bcd",field:"site_allow",align:"center",valign:"middle","class":"hidden-480",formatter:"siteAllowFormatter"}),columns_table.push({title:$("#month_select").html(),field:"pd_count",align:"center",valign:"middle",formatter:"pdNumFormatter"}),columns_table.push({title:"\u64cd\u4f5c",align:"center",valign:"middle","class":"action1",formatter:"operateFormatter"});var $table,vform;$(function(){$("#cart-left").addClass("active"),$table=initTable(columns_table,"?method=listAjax"),$table.on("check.bs.table",function(e,a){calcPrice()}),$table.on("uncheck.bs.table",function(e,a){calcPrice()}),$table.on("check-all.bs.table",function(e,a){calcPrice()}),$table.on("uncheck-all.bs.table",function(e,a){calcPrice()}),vform=$("#validation-form").validate({errorElement:"div",errorClass:"help-block",focusInvalid:!1,ignore:"",rules:{rel_name:{required:!0},rel_addr:{required:!0,url:!0}},messages:{rel_name:{required:"\u8bf7\u586b\u5199\u94fe\u63a5\u6587\u5b57"},rel_addr:{required:"\u8bf7\u586b\u5199\u94fe\u63a5\u5730\u5740",url:"\u8bf7\u6b63\u786e\u94fe\u63a5\u5730\u5740,\u9700\u5305\u542bhttp\u6216\u8005https"}},highlight:function(e){$(e).closest(".form-group").removeClass("has-info").addClass("has-error")},success:function(e){$(e).closest(".form-group").removeClass("has-error"),$(e).remove()}}),setTimeout(getShippingAddr,2e3)});var month_data=[{value:"1",name:"1\u4e2a\u6708"},{value:"2",name:"2\u4e2a\u6708"},{value:"3",name:"3\u4e2a\u6708"},{value:"6",name:"6\u4e2a\u6708"},{value:"12",name:"12\u4e2a\u6708"}],columns_table_addr=[];columns_table_addr.push({title:"\u94fe\u63a5\u6587\u5b57",field:"rel_name",align:"center",valign:"middle",shown:!0,type:"input",child_type:"text",required:!0,maxlength:128}),columns_table_addr.push({title:"\u94fe\u63a5\u5730\u5740",field:"rel_addr",align:"left",valign:"middle",shown:!0,type:"input",child_type:"text",value:"http://",required:!0,maxlength:128});